/* New Color Palette */
:root {
    --primary-bg: #FFFFFF;
    --secondary-bg: #E5E5E5;
    --accent: #FCA311;
    --primary-text: #14213D;
    --emphasis: #000000;

    /* Dark Mode Defaults */
    --bg-main: var(--primary-text);
    --bg-surface: rgba(0, 0, 0, 0.2);
    --bg-interactive: var(--accent);
    --bg-interactive-hover: #E89202;
    --text-main: var(--primary-bg);
    --text-secondary: var(--secondary-bg);
    --border-main: rgba(255, 255, 255, 0.1);
    --shadow-color: rgba(0, 0, 0, 0.4);
    --icon-color: var(--accent);
}

body {
    font-family: 'Inter', sans-serif;
    background-color: var(--bg-main);
    color: var(--text-main);
    overflow: hidden; /* Prevent scroll on body */
}

/* --- Global Component Styles & Transitions --- */
button, a {
    transition: background-color 0.2s ease-in-out, color 0.2s ease-in-out, border-color 0.2s ease-in-out, opacity 0.2s ease-in-out, transform 0.1s ease-in-out;
}

/* Global Theme Transitions */
* {
    transition: background-color 0.3s ease-in-out,
                color 0.3s ease-in-out,
                border-color 0.3s ease-in-out,
                box-shadow 0.3s ease-in-out;
}

/* Override for interactive elements to maintain snappy feel */
button, a, input, select, textarea, .mode-button {
    transition: background-color 0.2s ease-in-out,
                color 0.2s ease-in-out,
                border-color 0.2s ease-in-out,
                opacity 0.2s ease-in-out,
                transform 0.1s ease-in-out,
                box-shadow 0.2s ease-in-out;
}

/* Add a satisfying 'press' effect to all buttons */
button:active {
    transform: scale(0.97);
}

/* Main Sidebar Transitions */
#sidebar {
    transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1),
                box-shadow 0.3s ease-in-out;
}

#sidebar:not(.hidden) {
    box-shadow: 4px 0 20px var(--shadow-color);
}

/* Sidebar Overlay Transitions */
#sidebar-overlay {
    transition: opacity 0.3s ease-in-out,
                visibility 0.3s ease-in-out;
}

#sidebar-overlay:not(.hidden) {
    opacity: 1;
    visibility: visible;
}

#sidebar-overlay.hidden {
    opacity: 0;
    visibility: hidden;
}

/* Enhanced sidebar transitions - Now handled by specific sidebar IDs */

/* Right Sidebar Specific Transitions */
#right-sidebar, #flashcards-right-sidebar, #quiz-right-sidebar {
    transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1),
                opacity 0.3s ease-in-out,
                box-shadow 0.3s ease-in-out,
                visibility 0.3s ease-in-out;
}

/* Desktop Right Sidebar Transitions */
@media (min-width: 768px) {
    /* Desktop: Reset mobile positioning and use normal flow */
    #right-sidebar, #flashcards-right-sidebar, #quiz-right-sidebar {
        position: relative;
        transform: none;
        transition: opacity 0.3s ease-in-out,
                    box-shadow 0.3s ease-in-out,
                    visibility 0.3s ease-in-out;
    }
    
    #right-sidebar:not(.hidden), #flashcards-right-sidebar:not(.hidden), #quiz-right-sidebar:not(.hidden) {
        box-shadow: -4px 0 20px var(--shadow-color);
    }
    
    /* Right Sidebar Handle Button Transitions */
    #open-right-sidebar-handle {
        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    }
    
    #open-right-sidebar-handle:hover {
        transform: scale(1.1);
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
    }
    
    #open-right-sidebar-handle:active {
        transform: scale(0.95);
    }
}

/* Right Sidebar Content Transitions */
#chat-history-container, #flashcards-history-container, #quiz-history-container {
    transition: opacity 0.3s ease-in-out;
}

#chat-history-list, #flashcards-history-list, #quiz-history-list {
    transition: all 0.3s ease-in-out;
}

#chat-history-list li, #flashcards-history-list li, #quiz-history-list li {
    transition: all 0.2s ease-in-out;
}

#chat-history-list li:hover, #flashcards-history-list li:hover, #quiz-history-list li:hover {
    transform: translateX(4px);
    background-color: rgba(252, 163, 17, 0.1);
}

/* Right Sidebar Loading States */
#chat-history-loading, #flashcards-history-loading, #quiz-history-loading {
    transition: opacity 0.3s ease-in-out;
}

#chat-history-empty, #flashcards-history-empty, #quiz-history-empty {
    transition: opacity 0.3s ease-in-out;
}

/* Improved mobile sidebar behavior */
@media (max-width: 767px) {
    /* Mobile Right Sidebars - Slide in from right like main sidebar slides from left */
    #right-sidebar, #flashcards-right-sidebar, #quiz-right-sidebar {
        position: fixed;
        top: 0;
        right: 0;
        height: 100vh;
        width: 100%;
        max-width: 320px;
        transform: translateX(100%);
        transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        z-index: 50;
        will-change: transform;
    }
    
    /* When right sidebars are open/visible */
    #right-sidebar:not(.hidden), #flashcards-right-sidebar:not(.hidden), #quiz-right-sidebar:not(.hidden) {
        transform: translateX(0);
    }
    
    /* When right sidebars are closed/hidden */
    #right-sidebar.hidden, #flashcards-right-sidebar.hidden, #quiz-right-sidebar.hidden {
        transform: translateX(100%);
    }
    
    /* Mobile Right Sidebar Handle Transitions */
    #open-right-sidebar-handle {
        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    }
    
    #open-right-sidebar-handle:hover {
        transform: scale(1.1);
        box-shadow: 0 4px 12px var(--shadow-color);
    }
    
    #open-right-sidebar-handle:active {
        transform: scale(0.95);
    }
}

/* Enhanced tablet responsiveness */
@media (min-width: 768px) and (max-width: 1024px) {
    .glass-effect {
        backdrop-filter: blur(16px) saturate(120%);
        -webkit-backdrop-filter: blur(16px) saturate(120%);
    }
    
    .mode-button {
        padding: 0.75rem 1rem;
        font-size: 0.875rem;
    }
}

/* Large desktop optimizations */
@media (min-width: 1440px) {
    .glass-effect {
        backdrop-filter: blur(24px) saturate(180%);
        -webkit-backdrop-filter: blur(24px) saturate(180%);
    }
    
    .mode-button {
        padding: 1rem 1.5rem;
        font-size: 1rem;
    }
}

/* --- Professional Button System --- */

/* Primary Action Buttons (Seance) */
.bg-violet-600 {
    background-color: var(--seance-500);
    color: #ffffff;
    border: 1px solid transparent;
    transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
    position: relative;
    overflow: hidden;
}

.bg-violet-600:hover {
    background-color: var(--seance-600);
    transform: translateY(-1px);
    box-shadow: 0 4px 12px rgba(178, 89, 220, 0.3);
}

.bg-violet-600:active {
    transform: translateY(0);
    box-shadow: 0 2px 6px rgba(178, 89, 220, 0.2);
}

.light-mode .bg-violet-600 {
    background-color: var(--seance-400);
    color: #ffffff;
    box-shadow: 0 2px 4px rgba(202, 135, 235, 0.2);
}

.light-mode .bg-violet-600:hover {
    background-color: var(--seance-500);
    box-shadow: 0 4px 12px rgba(202, 135, 235, 0.3);
}

/* Secondary Action Buttons */
.bg-slate-800\/60 {
    background-color: rgba(30, 41, 59, 0.6);
    color: #e2e8f0;
    border: 1px solid rgba(255, 255, 255, 0.1);
    transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
}

.bg-slate-800\/60:hover {
    background-color: rgba(30, 41, 59, 0.8);
    border-color: rgba(255, 255, 255, 0.2);
    transform: translateY(-1px);
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
}

.light-mode .bg-slate-800\/60 {
    background-color: rgba(226, 232, 240, 0.6);
    color: #0f172a;
    border-color: rgba(0, 0, 0, 0.1);
}

.light-mode .bg-slate-800\/60:hover {
    background-color: rgba(226, 232, 240, 0.8);
    border-color: rgba(0, 0, 0, 0.2);
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
}

.glass-effect {
    background: rgba(30, 41, 59, 0.6); /* Enhanced opacity for better contrast */
    backdrop-filter: blur(20px) saturate(150%);
    -webkit-backdrop-filter: blur(20px) saturate(150%);
    border: 1px solid rgba(255, 255, 255, 0.15);
    border-radius: 1rem;
    box-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.4), 
                0 0 0 1px rgba(255, 255, 255, 0.05);
    transition: all 0.3s ease-in-out;
}

.glass-effect:hover {
    backdrop-filter: blur(24px) saturate(180%);
    -webkit-backdrop-filter: blur(24px) saturate(180%);
    box-shadow: 0 12px 40px 0 rgba(0, 0, 0, 0.5), 
                0 0 0 1px rgba(255, 255, 255, 0.1);
}

@keyframes blob {
    0% { transform: translate(0px, 0px) scale(1); filter: hue-rotate(0deg); }
    25% { transform: translate(100px, -50px) scale(1.2); }
    50% { transform: translate(-80px, 60px) scale(0.8); filter: hue-rotate(180deg); }
    75% { transform: translate(50px, -100px) scale(1.1); }
    100% { transform: translate(0px, 0px) scale(1); filter: hue-rotate(0deg); }
}

.animate-blob { 
    animation: blob 20s infinite cubic-bezier(0.68, -0.55, 0.27, 1.55); 
}
.animation-delay-2000 { animation-delay: -5s; }
.animation-delay-4000 { animation-delay: -10s; }

#chat-window::-webkit-scrollbar, .sidebar-scroll::-webkit-scrollbar, .modal-scroll::-webkit-scrollbar { width: 6px; }
#chat-window::-webkit-scrollbar-track, .sidebar-scroll::-webkit-scrollbar-track, .modal-scroll::-webkit-scrollbar-track { background: transparent; }
#chat-window::-webkit-scrollbar-thumb, .sidebar-scroll::-webkit-scrollbar-thumb, .modal-scroll::-webkit-scrollbar-thumb {
    background-color: rgba(178, 89, 220, 0.6); /* Seance 500 with opacity */
    border-radius: 20px;
    border: 3px solid transparent;
    transition: background-color 0.2s ease-in-out;
}

#chat-window::-webkit-scrollbar-thumb:hover, .sidebar-scroll::-webkit-scrollbar-thumb:hover, .modal-scroll::-webkit-scrollbar-thumb:hover {
    background-color: rgba(178, 89, 220, 0.8); /* Seance 500 with higher opacity */
}

@keyframes bounce {
    0%, 100% { transform: translateY(0); }
    50% { transform: translateY(-6px); }
}
.dot { animation: bounce 1.2s infinite; }
.dot:nth-child(2) { animation-delay: 0.2s; }
.dot:nth-child(3) { animation-delay: 0.4s; }

.flashcard-inner { transform-style: preserve-3d; transition: transform 0.6s; }
.is-flipped .flashcard-inner { transform: rotateY(180deg); }
.flashcard-front, .flashcard-back { 
    -webkit-backface-visibility: hidden;
    backface-visibility: hidden;
}
.flashcard-back { transform: rotateY(180deg); }

/* Mode Buttons (Chat, Flashcards, Quiz) */
.mode-button {
    background-color: rgba(51, 65, 85, 0.6);
    color: #d1d5db;
    border: 1px solid rgba(255, 255, 255, 0.05);
    transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
    position: relative;
    overflow: hidden;
}

.mode-button:hover {
    background-color: rgba(51, 65, 85, 0.8);
    border-color: rgba(255, 255, 255, 0.1);
    transform: translateY(-1px);
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
}

.mode-button:active {
    transform: translateY(0);
}

.mode-button.active {
    background-color: rgba(30, 41, 59, 0.9);
    color: #f8fafc;
    font-weight: 600;
    border: 1px solid var(--seance-500);
    box-shadow: 0 0 0 1px rgba(178, 89, 220, 0.3), 
                0 4px 12px rgba(178, 89, 220, 0.2);
    transform: translateY(-1px);
}

/* Light mode mode buttons */
.light-mode .mode-button {
    background-color: rgba(226, 232, 240, 0.6);
    color: #334155;
    border-color: rgba(0, 0, 0, 0.05);
}

.light-mode .mode-button:hover {
    background-color: rgba(226, 232, 240, 0.8);
    border-color: rgba(0, 0, 0, 0.1);
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
}

.light-mode .mode-button.active {
    background-color: rgba(255, 255, 255, 0.9);
    color: #0f172a;
    border-color: var(--seance-400);
    box-shadow: 0 0 0 1px rgba(202, 135, 235, 0.3), 
                0 4px 12px rgba(202, 135, 235, 0.2);
}

/* --- View Transitions --- */
@keyframes view-enter {
    from { opacity: 0; transform: scale(0.98); }
    to { opacity: 1; transform: scale(1); }
}

.view-enter-active {
    animation: view-enter 0.3s ease-in-out;
}

/* View transitions are handled by view-enter-active class */

/* Modal Transitions */
#login-modal, #register-modal, #settings-modal, #feedback-modal {
    transition: opacity 0.3s ease-in-out,
                visibility 0.3s ease-in-out;
}

#login-modal:not(.hidden), #register-modal:not(.hidden), 
#settings-modal:not(.hidden), #feedback-modal:not(.hidden) {
    opacity: 1;
    visibility: visible;
}

#login-modal.hidden, #register-modal.hidden, 
#settings-modal.hidden, #feedback-modal.hidden {
    opacity: 0;
    visibility: hidden;
}

/* Modal Content Transitions */
#login-modal .glass-effect, #register-modal .glass-effect,
#settings-modal .glass-effect, #feedback-modal .glass-effect {
    transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1),
                opacity 0.3s ease-in-out;
}

#login-modal:not(.hidden) .glass-effect, #register-modal:not(.hidden) .glass-effect,
#settings-modal:not(.hidden) .glass-effect, #feedback-modal:not(.hidden) .glass-effect {
    transform: scale(1);
    opacity: 1;
}

#login-modal.hidden .glass-effect, #register-modal.hidden .glass-effect,
#settings-modal.hidden .glass-effect, #feedback-modal.hidden .glass-effect {
    transform: scale(0.95);
    opacity: 0;
}

/* View transitions */
.view {
    transition: opacity 0.3s ease-in-out,
                transform 0.3s ease-in-out;
}

.view-hidden {
    opacity: 0;
    transform: scale(0.98);
    pointer-events: none;
}

/* --- Spinner --- */
.spinner {
    width: 24px;
    height: 24px;
    border: 3px solid rgba(255, 255, 255, 0.2);
    border-top-color: #b259dc; /* Seance 500 */
    border-radius: 50%;
    animation: spin 1s linear infinite;
    margin: 0 auto; /* Center the spinner */
}

.light-mode .spinner {
    border: 3px solid rgba(0, 0, 0, 0.1);
    border-top-color: #ca87eb; /* Seance 400 for light mode */
}

@keyframes spin {
    0% { transform: rotate(0deg); }
    100% { transform: rotate(360deg); }
}

/* --- Message Fade-in Animation --- */
@keyframes fadeInMessage {
    from { opacity: 0; transform: translateY(10px); }
    to { opacity: 1; transform: translateY(0); }
}

.message-fade-in {
    animation: fadeInMessage 0.3s ease-in-out;
}

/* Chat Interface Transitions */
#chat-window {
    transition: all 0.3s ease-in-out;
}

#typing-indicator {
    transition: opacity 0.3s ease-in-out,
                transform 0.3s ease-in-out;
}

#typing-indicator:not(.hidden) {
    opacity: 1;
    transform: translateY(0);
}

#typing-indicator.hidden {
    opacity: 0;
    transform: translateY(-10px);
}

/* Form Input Transitions */
#message-input, #email, #password, #register-username, #register-email, #register-password {
    transition: border-color 0.2s ease-in-out,
                box-shadow 0.2s ease-in-out,
                transform 0.1s ease-in-out;
}

#message-input:focus, #email:focus, #password:focus, 
#register-username:focus, #register-email:focus, #register-password:focus {
    transform: scale(1.02);
}

/* Progress Bar Transitions */
#quiz-progress-bar {
    transition: width 0.5s cubic-bezier(0.4, 0, 0.2, 1);
}

/* Flashcard Transitions */
.flashcard {
    transition: transform 0.3s ease-in-out;
}

.flashcard:hover {
    transform: scale(1.02);
}

.flashcard-inner {
    transition: transform 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

/* Quiz Options Transitions */
#quiz-options button {
    transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
}

#quiz-options button:hover {
    transform: translateY(-2px);
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
}

#quiz-options button:active {
    transform: translateY(0);
}

/* --- Toast Notifications --- */
.toast {
    background-color: rgba(30, 41, 59, 0.8);
    color: #e2e8f0;
    padding: 12px 16px;
    border-radius: 8px;
    border: 1px solid rgba(255, 255, 255, 0.1);
    backdrop-filter: blur(10px);
    -webkit-backdrop-filter: blur(10px);
    display: flex;
    align-items: center;
    gap: 10px;
    animation: toast-in 0.3s ease-in-out;
}

@keyframes toast-in {
    from {
        opacity: 0;
        transform: translateX(100%);
    }
    to {
        opacity: 1;
        transform: translateX(0);
    }
}

.toast.success {
    background-color: rgba(74, 222, 128, 0.2);
    border-color: rgba(74, 222, 128, 0.5);
}

.toast.error {
    background-color: rgba(248, 113, 113, 0.2);
    border-color: rgba(248, 113, 113, 0.5);
} 

#login-modal, #register-modal {
    z-index: 100;
}

/* Light Mode */
body.light-mode {
    --bg-main: var(--primary-bg);
    --bg-surface: var(--secondary-bg);
    --text-main: var(--primary-text);
    --text-secondary: #4F5A70; /* Derived for less emphasis */
    --border-main: rgba(20, 33, 61, 0.15);
    --shadow-color: rgba(20, 33, 61, 0.15);
    --icon-color: var(--primary-text);
}

body.light-mode {
    background-color: var(--bg-main);
    color: var(--text-main);
}

.light-mode .glass-effect {
    background: rgba(255, 255, 255, 0.6);
    border: 1px solid var(--border-main);
    box-shadow: 0 8px 32px 0 var(--shadow-color),
                0 0 0 1px rgba(20, 33, 61, 0.05);
}

.light-mode .text-slate-100 {
    color: #0f172a; /* Slate 900 */
}

.light-mode .text-slate-200 {
    color: #1e293b; /* Slate 800 */
}

.light-mode .text-slate-300 {
    color: #334155; /* Slate 700 */
}

.light-mode .text-slate-400 {
    color: #475569; /* Slate 600 */
}

.light-mode .bg-slate-800\/50 {
    background-color: rgba(226, 232, 240, 0.5); /* Slate 200/50 */
}

.light-mode .bg-slate-800\/60 {
    background-color: #f8fafc; /* slate-50 */
    border: 1px solid #e2e8f0; /* slate-200 */
    color: #334155; /* slate-700 */
}

.light-mode .bg-slate-800\/60:hover {
    background-color: #f1f5f9; /* slate-100 */
    border-color: #cbd5e1; /* slate-300 */
}

/* Icon Button - Delete */
.delete-file-button:hover {
    background-color: rgba(255, 0, 0, 0.1);
    color: #ff0000;
}

.light-mode .delete-file-button:hover {
    background-color: rgba(255, 0, 0, 0.15);
}

.light-mode .border-white\/10 {
    border-color: rgba(0, 0, 0, 0.1);
}

.light-mode .hover\:bg-slate-800\/50:hover {
    background-color: rgba(203, 213, 225, 0.5); /* Slate 300/50 */
}

/* Close Buttons and Utility Buttons */
.rounded-full {
    transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
}

.rounded-full:hover {
    transform: scale(1.05);
    box-shadow: 0 4px 12px var(--shadow-color);
}

.light-mode .rounded-full:hover {
    box-shadow: 0 4px 12px var(--shadow-color);
}

.star {
    color: #9CA3AF; /* grayish */
    transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
    cursor: pointer;
}

.star:hover {
    transform: scale(1.2);
    color: #FCA311; /* your accent color */
    filter: drop-shadow(0 2px 4px rgba(252, 163, 17, 0.4));
}

.star.active {
    color: #FCA311;
}

.star:active {
    transform: scale(1.1);
}


/* Theme Switcher Button */
#theme-switcher {
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
}

#theme-switcher:hover {
    transform: scale(1.05);
}

#theme-switcher:active {
    transform: scale(0.95);
}

.light-mode #chat-window::-webkit-scrollbar-thumb, .light-mode .sidebar-scroll::-webkit-scrollbar-thumb, .light-mode .modal-scroll::-webkit-scrollbar-thumb {
    background-color: rgba(252, 163, 17, 0.6);
}

.light-mode .bg-slate-700\/50 {
    background-color: rgba(226, 232, 240, 0.5); /* Slate 200/50 */
}

.light-mode .border-slate-700\/50 {
    border-color: rgba(203, 213, 225, 0.5); /* Slate 300/50 */
}

.light-mode .placeholder-slate-400::placeholder {
    color: var(--text-secondary);
}

.light-mode .bg-violet-500\/20 {
    background-color: rgba(252, 163, 17, 0.15);
}

.light-mode .flashcard-front {
    background-color: var(--primary-bg);
}

.light-mode .flashcard-back {
    background-color: #E5E5E5; /* Light Grey */
}

#open-settings-button img {
    background-color: #333; /* Dark Grey */
}

.light-mode #open-settings-button img {
    background-color: #ccc; /* Light Grey */
}

.light-mode #quiz-options button {
    background-color: rgba(226, 232, 240, 0.6);
}

.light-mode #quiz-options button:hover {
    background-color: rgba(203, 213, 225, 0.8);
}

/* Ensure highlight colors are visible in light mode */
.light-mode #quiz-options button.correct-answer { background-color: var(--accent) !important; color: var(--primary-text); }
.light-mode #quiz-options button.incorrect-answer { background-color: var(--emphasis) !important; color: var(--primary-bg); }

/* --- Theme-Specific Overrides --- */
.light-mode {
    --light-blob-1: #A78BFA; /* Light Purple */
    --light-blob-2: #7DD3FC; /* Light Blue */
    --light-blob-3: #FBBF24; /* Amber */
}

.light-mode .bg-violet-600 { background-color: var(--light-blob-1); }
.light-mode .bg-indigo-600 { background-color: var(--light-blob-2); }
.light-mode .bg-sky-600 { background-color: var(--light-blob-3); }

.light-mode #chat-window::-webkit-scrollbar-thumb, 
.light-mode .sidebar-scroll::-webkit-scrollbar-thumb, 
.light-mode .modal-scroll::-webkit-scrollbar-thumb {
    background-color: rgba(252, 163, 17, 0.6);
}

.light-mode #chat-window::-webkit-scrollbar-thumb:hover, 
.light-mode .sidebar-scroll::-webkit-scrollbar-thumb:hover, 
.light-mode .modal-scroll::-webkit-scrollbar-thumb:hover {
    background-color: rgba(252, 163, 17, 0.8);
}


/* --- Fix & Optimize: Mobile chat message input (dark + light mode) --- */
@media (max-width: 767px) {
    #chat-window {
        flex: 1;
        overflow-y: auto;
        padding-bottom: 72px; /* Space for input form */
        scroll-behavior: smooth;
        transition: all 0.3s ease-in-out;
    }

    /* The bottom input container */
    #chat-view > div:last-child {
        position: fixed;
        bottom: 0;
        left: 0;
        right: 0;
        background: rgba(20, 33, 61, 0.8); /* Dark primary text with blur */
        backdrop-filter: blur(16px);
        -webkit-backdrop-filter: blur(16px);
        border-top: 1px solid var(--border-main);
        box-shadow: 0 -2px 10px var(--shadow-color);
        padding: 10px 12px;
        z-index: 50;
        transition: all 0.3s ease-in-out;
    }
    
    /* Mobile sidebar handle transitions */
    #open-left-sidebar-handle, #open-right-sidebar-handle {
        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    }
    
    #open-left-sidebar-handle:hover, #open-right-sidebar-handle:hover {
        transform: scale(1.1);
        box-shadow: 0 4px 12px var(--shadow-color);
    }
    
    /* Mobile menu button transitions */
    #menu-button {
        transition: all 0.2s ease-in-out;
    }
    
    #menu-button:hover {
        transform: scale(1.1);
        background-color: rgba(252, 163, 17, 0.1);
    }
    
    /* Mobile mode button transitions */
    .mode-button {
        transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
        min-height: 44px;
        touch-action: manipulation;
    }
    
    .mode-button:active {
        transform: scale(0.95);
    }
    
    /* Mobile form transitions */
    #chat-form {
        transition: all 0.3s ease-in-out;
    }
    
    #message-input {
        transition: all 0.2s ease-in-out;
    }
    
    #message-input:focus {
        transform: scale(1.02);
        box-shadow: 0 0 0 2px rgba(252, 163, 17, 0.3);
    }

    /* Light mode adaptation */
    body.light-mode #chat-view > div:last-child {
        background: rgba(255, 255, 255, 0.8); /* Subtle glass white */
        border-top: 1px solid var(--border-main);
        box-shadow: 0 -2px 10px var(--shadow-color);
    }

    #chat-form {
        display: flex;
        align-items: center;
        gap: 8px;
    }

    #message-input {
        flex: 1;
        min-height: 44px;
        background-color: rgba(30, 41, 59, 0.6);
        border: 1px solid rgba(255, 255, 255, 0.08);
        border-radius: 0.5rem;
        color: #f8fafc;
        padding: 10px 12px;
    }

    #message-input::placeholder {
        color: #94a3b8;
    }

    /* Light mode input adjustments */
    body.light-mode #message-input {
        background-color: rgba(241, 245, 249, 0.8); /* Slate 100 */
        border-color: rgba(0, 0, 0, 0.1);
        color: #0f172a;
    }

    body.light-mode #message-input::placeholder {
        color: #64748b;
    }

    /* Send button */
    #chat-form button {
        background-color: var(--bg-interactive);
        color: var(--primary-text);
        border-radius: 0.5rem;
        padding: 10px;
        transition: background-color 0.2s ease-in-out, transform 0.1s ease-in-out;
    }

    #chat-form button:hover {
        background-color: var(--bg-interactive-hover);
        transform: scale(1.02);
    }

    body.light-mode #chat-form button {
        background-color: var(--bg-interactive);
        color: var(--primary-text);
    }

    body.light-mode #chat-form button:hover {
        background-color: var(--bg-interactive-hover);
    }

    body {
        overflow: auto; /* Enable scroll on mobile */
    }
}


.light-mode #chat-history-list li, .light-mode #flashcards-history-list li, .light-mode #quiz-history-list li {
    background-color: rgba(20, 33, 61, 0.05);
}

.light-mode .toast {
    color: var(--primary-text);
}

#file-management-section {
    display: none;
}

.logged-in #file-management-section {
    display: block;
}

#login-signup-button {
    background-color: var(--bg-interactive);
    font-weight: bold;
    transition: background-color 0.2s ease-in-out, transform 0.1s ease-in-out;
}

#login-signup-button:hover {
    background-color: var(--bg-interactive-hover);
    transform: scale(1.02);
}

.logged-in #login-signup-button {
    display: none;
}

.logged-in #open-settings-button {
    display: flex;
}

/* Right sidebar open handle (desktop) */
#open-right-sidebar-handle {
    line-height: 1;
}

/* Hide the right sidebar handle on mobile; it is desktop-only */
@media (max-width: 767px) {
    #open-right-sidebar-handle {
        display: none !important;
    }
}

/* Left sidebar handle (desktop only) */
#open-left-sidebar-handle { line-height: 1; }
@media (max-width: 767px) {
    #open-left-sidebar-handle { display: none !important; }
}